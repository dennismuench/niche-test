!function(t){var e={};function o(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=e,o.d=function(t,e,s){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(s,n,function(e){return t[e]}.bind(null,n));return s},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/static/",o(o.s=3)}([function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=o(4),n=void 0!==window.pageXOffset,i=document.createElement("div"),r=i.matches||i.matchesSelector||i.msMatchesSelector||i.mozMatchesSelector||i.webkitMatchesSelector||i.oMatchesSelector;class c{constructor(t){if(void 0===t)this.collection=[];else{if(t instanceof c)return t;if("string"==typeof t){const e=document.querySelectorAll(t);this.collection=e?Array.prototype.slice.call(e):[]}else NodeList.prototype.isPrototypeOf(t)?this.collection=Array.prototype.slice.call(t):t instanceof Window||Element.prototype.isPrototypeOf(t)?this.collection=[t]:this.collection=[]}}get(t=0){return this.collection[t]}each(t){for(let e=0,o=this.collection.length;e<o;e+=1)t(this.collection[e]);return this}find(t){return 0===this.collection.length?new c:new c(this.collection[0].querySelectorAll(t))}text(t){if(void 0===t)return this.collection.length>0&&this.collection[0].textContent||"";for(let e=0,o=this.collection.length;e<o;e+=1)this.collection[e].textContent=t;return this}html(t){if(void 0===t)return this.collection.length>0&&this.collection[0].innerHTML||"";for(let e=0,o=this.collection.length;e<o;e+=1)this.collection[e].innerHTML=t;return this}attr(t,e){if(void 0===e)return this.collection.length>0&&this.collection[0].getAttribute(t)||"";for(let o=0,s=this.collection.length;o<s;o+=1)this.collection[o].setAttribute(t,e);return this}css(t,e){for(let o=0,n=this.collection.length;o<n;o+=1)this.collection[o].style[s(t,!0)]=e;return this}removeClass(t){for(let e=0,o=this.collection.length;e<o;e+=1)this.collection[e].classList.remove(t);return this}addClass(t){for(let e=0,o=this.collection.length;e<o;e+=1)this.collection[e].classList.add(t);return this}hasClass(t){return this.collection.length>0&&this.collection[0].classList.contains(t)}is(t){return 0!==this.collection.length&&r.call(this.collection[0],t)}contains(t){const e=t instanceof c?t.get():t;return this.collection.length>0&&void 0!==e&&(this.collection[0]!==e&&this.collection[0].contains(e))}on(t,e){const o=t.split(/\W/);for(let t=0,s=this.collection.length;t<s;t+=1)for(let s=o.length-1;s>-1;s-=1)this.collection[t].addEventListener(o[s],e);return this}off(t,e){const o=t.split(/\W/);for(let t=0,s=this.collection.length;t<s;t+=1)for(let s=o.length-1;s>-1;s-=1)this.collection[t].removeEventListener(o[s],e);return this}static scrollX(t){return void 0===t?n?window.pageXOffset:Math.max(document.documentElement.scrollLeft,document.body.scrollLeft):n?window.scrollTo(t,window.pageYOffset):document.body.scrollLeft=document.documentElement.scrollLeft=t}static scrollY(t){return void 0===t?n?window.pageYOffset:Math.max(document.documentElement.scrollTop,document.body.scrollTop):n?window.scrollTo(window.pageXOffset,t):document.body.scrollTop=document.documentElement.scrollTop=t}static get(t){return new Promise((e,o)=>{const s=new XMLHttpRequest;s.open("GET",t,!0),s.onload=function(){this.status>=200&&this.status<400?e(String(this.response)):o()},s.onerror=(()=>o()),s.send()})}}e.DOM=c},function(t,e){t.exports=function(t){return null==t?"":""+t}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=o(0),n=o(9),i=o(10),r=o(11);e.K={Selector:new n.Selector(new s.DOM(".k-selector"))},new i.Carousel(new s.DOM(".k-carousel")),new r.Document(new s.DOM(".k-document"))},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=o(2);window.K=s.K},function(t,e,o){var s=o(5),n=o(8);t.exports=function(t,e){return t=s(t).replace(/[-_\s]+(.)?/g,function(t,e){return e?e.toUpperCase():""}),!0===e?n(t):t}},function(t,e,o){var s=o(1),n=o(6),i=String.prototype.trim;t.exports=function(t,e){return t=s(t),!e&&i?i.call(t):(e=n(e),t.replace(new RegExp("^"+e+"+|"+e+"+$","g"),""))}},function(t,e,o){var s=o(7);t.exports=function(t){return null==t?"\\s":t.source?t.source:"["+s(t)+"]"}},function(t,e,o){var s=o(1);t.exports=function(t){return s(t).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}},function(t,e,o){var s=o(1);t.exports=function(t){return(t=s(t)).charAt(0).toLowerCase()+t.slice(1)}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=o(0);e.Selector=class{constructor(t){this.dom=t,this.shownContentsChooser=!1,this.shownLanguageChooser=!1,this.shown=!1,this.scrollYPosition=s.DOM.scrollY(),this.contents=this.dom.find(".k--contents"),this.language=this.dom.find(".k--language"),this.body=new s.DOM(document.body)}contentsChooser(){return this.shown?(this.shownContentsChooser?this.hide():this.showContentsChooser(),this):(this.shownContentsChooser||this.showContentsChooser(),this.show(),this)}languageChooser(){return this.shown?(this.shownLanguageChooser?this.hide():this.showLanguageChooser(),this):(this.shownLanguageChooser||this.showLanguageChooser(),this.show(),this)}show(){this.scrollYPosition=s.DOM.scrollY(),this.dom.addClass("k--active"),this.body.addClass("k--selector-active"),this.shown=!0}hide(){this.dom.removeClass("k--active"),this.body.removeClass("k--selector-active"),s.DOM.scrollY(this.scrollYPosition),this.shown=!1}showLanguageChooser(){this.shownContentsChooser=!1,this.shownLanguageChooser=!0,this.contents.removeClass("k--active"),this.language.addClass("k--active")}showContentsChooser(){this.shownContentsChooser=!0,this.shownLanguageChooser=!1,this.contents.addClass("k--active"),this.language.removeClass("k--active")}}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Carousel=class{constructor(t){this.dom=t,this.imgs=[],this.cursor=0,this.blur=this.dom.find(".k--blur"),this.blurImage=this.blur.find("image"),this.show=this.dom.find(".k--show"),this.load=this.dom.find(".k--load"),this.page=this.dom.find(".k--page"),this.nextButton=this.dom.find(".k--next"),this.prevButton=this.dom.find(".k--prev"),this.nextButton&&this.nextButton.on("click",this.next.bind(this)),this.prevButton&&this.prevButton.on("click",this.prev.bind(this)),this.preload()}next(){return this.cursor=this.cursor<this.imgs.length-1?this.cursor+1:0,this.update()}prev(){return this.cursor=this.cursor>0?this.cursor-1:this.imgs.length-1,this.update()}preload(){const t=this.dom.find("img"),e=[];t.each(t=>{e.push(new Promise((e,o)=>{const s=new Image;s.onload=(()=>e(t.src)),s.onerror=(()=>{console.error("Unable to load image,",t.src),e()}),s.src=t.src}))}),Promise.all(e).then(t=>{this.imgs=t,this.update()})}update(){if(0!==this.imgs.length)return this.show.css("background-image",`url(${this.imgs[this.cursor]})`),this.page.text(`${this.cursor+1} / ${this.imgs.length}`),this.blurImage.each(t=>{t.setAttributeNS("http://www.w3.org/1999/xlink","href",this.imgs[this.cursor])}),this}}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=o(0),n=o(2),i="k--load",r="k--fail",c="index.ajax";e.Document=class{constructor(t){this.dom=t,this.body=new s.DOM(document.body),this.body.hasClass("k--development")||(this.body.on("click",this.onDocumentRequest.bind(this)),new s.DOM(window).on("popstate",this.onHistoryStateChange.bind(this)),this.body.find("a.k--document").each(t=>{if(!this.dom.contains(t)){const e=new s.DOM(t);e.attr("href",l(e.attr("href")))}}))}onHistoryStateChange(t){console.log(history.state),this.dom.html(history.state.document)}onDocumentRequest(t){const e=new s.DOM(t.target);if(e.is("a.k--document")){t.preventDefault();const o=e.attr("href");if(o)return void this.documentRequest(e,this.dom.contains(e)?l(o):o)}}documentRequest(t,e){t.removeClass(r),t.addClass(i),s.DOM.get(e+c).then(o=>{this.dom.html(o);const s=this.dom.find(".k-article").attr("data-title");t.removeClass(i),n.K.Selector.hide(),history.pushState({document:o,title:s},"TODO: get title",e)}).catch(()=>{t.removeClass(i),t.addClass(r)})}};const l=t=>{const e=location.pathname.split("/"),o=t.split("/");e.pop();for(let t=0;t<o.length;t+=1)"."!==o[t]&&(".."===o[t]?e.pop():e.push(o[t]));return e.join("/")}}]);